<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CanLite Overlay</title>
    <style>
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            display: none;
        }

        #ad-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90vw;
            height: 90vh;
            z-index: 10001;
            display: none;
        }
    </style>
</head>
<body>
<h1>Main Content</h1>
<p>Your regular page content here</p>

<div class="overlay"></div>
<div id="ad-container"></div>

<script>
    function initAdOverlay() {
        const overlay = document.querySelector('.overlay');
        const adContainer = document.querySelector('#ad-container');

        // Create shadow DOM
        const shadowRoot = adContainer.attachShadow({ mode: 'open' });

        // Random time between 10-15 seconds
        const displayTime = Math.floor(Math.random() * 6) + 10;

        shadowRoot.innerHTML = `
                <style>
                    :host {
                        display: block;
                        background: #89b4fa;
                        border-radius: 12px;
                        padding: 20px;
                        box-shadow: 0 0 20px rgba(0,0,0,0.3);
                        text-align: center;
                    }
                    .content {
                        height: 100%;
                        display: flex;
                        flex-direction: column;
                        justify-content: center;
                    }
                    .message {
                        font-size: 1.5em;
                        margin-bottom: 20px;
                    }
                    .timer {
                        font-size: 1.2em;
                        color: #d9534f;
                        font-weight: bold;
                    }
                    .ad-wrapper {
                        margin: 20px auto;
                        width: 700px;
                        height: 500px;
                        background: rgba(255,255,255,0.9);
                        border-radius: 8px;
                        padding: 10px;
                    }
                </style>
                <div class="content">
                    <div class="message">
                        Help keep CanLite free<br>
                        <span class="timer">${displayTime}</span> seconds remaining
                    </div>
                    <div class="ad-wrapper">
                        <!-- Ad content will be injected here -->
                    </div>
                </div>
            `;

        // Attempt to load AdSense
        const adWrapper = shadowRoot.querySelector('.ad-wrapper');
        const timerElement = shadowRoot.querySelector('.timer');

        const adScript = document.createElement('script');
        adScript.async = true;
        adScript.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1655414789495559';
        adScript.crossOrigin = 'anonymous';

        adScript.onload = () => {
            // Create AdSense ad
            const ins = document.createElement('ins');
            ins.className = 'adsbygoogle';
            ins.style.display = 'block';
            ins.dataset.adClient = 'ca-pub-1655414789495559';
            ins.dataset.adSlot = '7467137497';
            ins.dataset.adFormat = 'auto';
            ins.dataset.fullWidthResponsive = 'true';

            adWrapper.appendChild(ins);
            (adsbygoogle = window.adsbygoogle || []).push({});

            // Show overlay
            overlay.style.display = 'block';
            adContainer.style.display = 'block';

            // Start timer
            let seconds = displayTime;
            const timerInterval = setInterval(() => {
                seconds--;
                timerElement.textContent = seconds;
                if (seconds <= 0) {
                    clearInterval(timerInterval);
                    overlay.style.display = 'none';
                    adContainer.style.display = 'none';
                }
            }, 1000);
        };

        adScript.onerror = () => {
            // Fallback if AdSense is blocked
            if(typeof aclib !== 'undefined') {
                aclib.runAutoTag({ zoneId: 'yhqj50takh' });
            }
            // Don't show the overlay if ads are blocked
        };

        document.head.appendChild(adScript);
    }

    // Initial call
    initAdOverlay();

    // Repeat every 5 minutes (300000ms)
    setInterval(initAdOverlay, 300000);
</script>
</body>
</html>